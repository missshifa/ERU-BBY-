const axios = require("axios");

module.exports.config = {
  name: "ajan",
  version: "2.1",
  hasPermssion: 0,
  credits: "ALVI (Fixed by GPT)",
  description: "à¦¸à§‡à¦Ÿ à¦•à¦°à¦¾ à¦¸à¦®à¦¯à¦¼ à¦…à¦¨à§à¦¯à¦¾à¦¯à¦¼à§€ à¦¸à§à¦¬à¦¯à¦¼à¦‚à¦•à§à¦°à¦¿à¦¯à¦¼à¦­à¦¾à¦¬à§‡ à¦¬à¦¾à¦°à§à¦¤à¦¾à¦—à§à¦²à¦¿ à¦ªà¦¾à¦ à¦¾à¦¨à§‹ à¦¹à¦¬à§‡!",
  commandCategory: "AutoTime",
  countDown: 3
};

module.exports.onLoad = async ({ api }) => {
  const prayerTimes = {
    "04:32 AM": {
      message: ". â•­â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•®\nâ€¢â€”Â»âœ¨à¦«à¦œà¦°à§‡à¦° à¦†à¦œà¦¾à¦¨âœ¨Â«â€”â€¢\n â•°â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•¯\n\nâ‹†âœ¦â‹† à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦® ðŸ–¤ðŸ’«\nà¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨ à¦à¦–à¦¨ à¦«à¦œà¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ à¦¸à¦¬à¦¾à¦‡ à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨ âœ¨ðŸ§¡\nâ€”ð€ð‹ð•ðˆ ð‚ð‡ð€ð“ ððŽð“ðŸŒ¸",
      url: "https://drive.google.com/uc?id=1mB8EpEEbVKZo6iI7GJwuMpb1MMj72kby"
    },
    "11:56 AM": {
      message: ". â•­â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•®\nâ€¢â€”Â»âœ¨à¦œà§‹à¦¹à¦°à§‡à¦° à¦†à¦œà¦¾à¦¨âœ¨Â«â€”â€¢\n â•°â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•¯\n\nâ‹†âœ¦â‹† à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦® ðŸ–¤ðŸ’«\nà¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨ à¦à¦–à¦¨ à¦œà§‹à¦¹à¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ à¦¸à¦¬à¦¾à¦‡ à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨ âœ¨ðŸ§¡\nâ€”ð€ð‹ð•ðˆ ð‚ð‡ð€ð“ ððŽð“ðŸŒ¸",
      url: "https://drive.google.com/uc?id=1mNVwfsTEM-VjliXoM464EQR1gTYYG2ay"
    },
    "04:17 PM": {
      message: ". â•­â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•®\nâ€¢â€”Â»âœ¨à¦†à¦¸à¦°à§‡à¦° à¦†à¦œà¦¾à¦¨âœ¨Â«â€”â€¢\n â•°â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•¯\n\nâ‹†âœ¦â‹† à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦® ðŸ–¤ðŸ’«\nà¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨ à¦à¦–à¦¨ à¦†à¦¸à¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ à¦¸à¦¬à¦¾à¦‡ à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨ âœ¨ðŸ§¡\nâ€”ð€ð‹ð•ðˆ ð‚ð‡ð€ð“ ððŽð“ðŸŒ¸",
      url: "https://drive.google.com/uc?id=1mkNnhFFvSpTIQSpw0qqAlkvtqaxH8BTy"
    },
    "06:05 PM": {
      message: ". â•­â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•®\nâ€¢â€”Â»âœ¨à¦®à¦¾à¦—à¦°à¦¿à¦¬à§‡à¦° à¦†à¦œà¦¾à¦¨âœ¨Â«â€”â€¢\n â•°â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•¯\n\nâ‹†âœ¦â‹† à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦® ðŸ–¤ðŸ’«\nà¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨ à¦à¦–à¦¨ à¦®à¦¾à¦—à¦°à¦¿à¦¬à§‡à¦° à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ à¦¸à¦¬à¦¾à¦‡ à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨ âœ¨ðŸ§¡\nâ€”ð€ð‹ð•ðˆ ð‚ð‡ð€ð“ ððŽð“ðŸŒ¸",
      url: "https://drive.google.com/uc?id=1m5jiP4q9FPqDbIX4BoNTbse57h2SpgmC"
    },
    "07:15 PM": {
      message: "â•­â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•®\nâ€¢â€”Â»âœ¨à¦‡à¦¶à¦¾à¦°à§‡à¦° à¦†à¦œà¦¾à¦¨âœ¨Â«â€”â€¢\nâ•°â€¢â”„â”…â•â•âðŸŒºââ•â•â”…â”„â€¢â•¯\n\nâ‹†âœ¦â‹† à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦® ðŸ–¤ðŸ’«\nà¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨ à¦à¦–à¦¨ à¦‡à¦¶à¦¾à¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ à¦¸à¦¬à¦¾à¦‡ à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨ âœ¨ðŸ§¡\nâ€”ð€ð‹ð•ðˆ ð‚ð‡ð€ð“ ððŽð“ðŸŒ¸",
      url: "https://drive.google.com/uc?id=1mP2HJlKRGRc2P9joj2IpA1wH-eSrtazz"
    }
  };

  let lastSent = null; // à¦à¦•à¦‡ à¦®à¦¿à¦¨à¦¿à¦Ÿà§‡ à¦¡à¦¾à¦¬à¦² à¦¸à§‡à¦¨à§à¦¡ à¦†à¦Ÿà¦•à¦¾à¦¬à§‡

  setInterval(async () => {
    const now = new Date(Date.now() + 21600000); // +6 GMT offset
    const currentTime = now.toLocaleTimeString("en-US", {
      hour: "2-digit",
      minute: "2-digit",
      hour12: true
    }).trim();

    if (prayerTimes[currentTime] && lastSent !== currentTime) {
      lastSent = currentTime;
      try {
        const attachment = (await axios.get(prayerTimes[currentTime].url, { responseType: "stream" })).data;
        const msg = { body: prayerTimes[currentTime].message, attachment };
        for (const tid of global.data.allThreadID) {
          api.sendMessage(msg, tid);
        }
      } catch (err) {
        console.error("Message send failed:", err);
      }
    }
  }, 15000); // à¦ªà§à¦°à¦¤à¦¿ 15 à¦¸à§‡à¦•à§‡à¦¨à§à¦¡à§‡ à¦Ÿà¦¾à¦‡à¦® à¦šà§‡à¦• à¦¹à¦¬à§‡
};

module.exports.run = () => {};
